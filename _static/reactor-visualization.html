<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuclear Reactor Visualization</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Additional custom styles if needed */
        .reactor-svg {
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const AnimatedReactor = () => {
          const [isRunning, setIsRunning] = React.useState(false);
          const [agitatorRotation, setAgitatorRotation] = React.useState(0);
          const [feedFlow, setFeedFlow] = React.useState(false);
          const [temperature, setTemperature] = React.useState(25);
          const [liquidLevel, setLiquidLevel] = React.useState(0.7);

          // Hard-coded trajectory data
          const trajectory = {
            duration: 10000, // 10 seconds
            keyframes: [
              { time: 0, temperature: 25, liquidLevel: 0.3, agitatorSpeed: 0 },
              { time: 2000, temperature: 45, liquidLevel: 0.5, agitatorSpeed: 120 },
              { time: 5000, temperature: 65, liquidLevel: 0.7, agitatorSpeed: 180 },
              { time: 8000, temperature: 55, liquidLevel: 0.8, agitatorSpeed: 150 },
              { time: 10000, temperature: 35, liquidLevel: 0.6, agitatorSpeed: 60 }
            ]
          };

          React.useEffect(() => {
            let animationFrame;
            let startTime;

            if (isRunning) {
              const animate = (currentTime) => {
                if (!startTime) startTime = currentTime;
                const elapsed = (currentTime - startTime) % trajectory.duration;
                
                // Find current keyframe
                let currentKeyframe = trajectory.keyframes[0];
                let nextKeyframe = trajectory.keyframes[1];
                
                for (let i = 0; i < trajectory.keyframes.length - 1; i++) {
                  if (elapsed >= trajectory.keyframes[i].time && elapsed <= trajectory.keyframes[i + 1].time) {
                    currentKeyframe = trajectory.keyframes[i];
                    nextKeyframe = trajectory.keyframes[i + 1];
                    break;
                  }
                }

                // Interpolate between keyframes
                const progress = (elapsed - currentKeyframe.time) / (nextKeyframe.time - currentKeyframe.time);
                const easedProgress = 0.5 * (1 + Math.sin(Math.PI * progress - Math.PI / 2)); // Smooth easing

                const currentTemp = currentKeyframe.temperature + (nextKeyframe.temperature - currentKeyframe.temperature) * easedProgress;
                const currentLevel = currentKeyframe.liquidLevel + (nextKeyframe.liquidLevel - currentKeyframe.liquidLevel) * easedProgress;
                const currentSpeed = currentKeyframe.agitatorSpeed + (nextKeyframe.agitatorSpeed - currentKeyframe.agitatorSpeed) * easedProgress;

                setTemperature(Math.round(currentTemp));
                setLiquidLevel(currentLevel);
                setAgitatorRotation(prev => prev + currentSpeed / 60); // Convert RPM to degrees per frame
                setFeedFlow(currentSpeed > 0);

                animationFrame = requestAnimationFrame(animate);
              };

              animationFrame = requestAnimationFrame(animate);
            }

            return () => {
              if (animationFrame) {
                cancelAnimationFrame(animationFrame);
              }
            };
          }, [isRunning]);

          const getTemperatureColor = (temp) => {
            if (temp < 30) return '#85b1c1'; // Cool blue
            if (temp < 50) return '#4CAF50'; // Green
            if (temp < 70) return '#FF9800'; // Orange
            return '#F44336'; // Hot red
          };

          const getLiquidHeight = () => {
            const maxHeight = 350; // Maximum liquid height in the reactor
            return maxHeight * liquidLevel;
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-500 to-indigo-600 p-5">
              <div className="max-w-6xl mx-auto bg-white rounded-2xl p-8 shadow-2xl">
                <h1 className="text-4xl font-bold text-center text-gray-800 mb-3">‚öõÔ∏è Nuclear Reactor Visualization</h1>
                <p className="text-xl text-center text-gray-600 mb-8">
                  Interactive visualization of a nuclear reactor with temperature, liquid level, and agitator control.
                </p>

                {/* Controls */}
                <div className="flex justify-center gap-4 mb-8 flex-wrap">
                  <button
                    onClick={() => setIsRunning(!isRunning)}
                    className={`px-6 py-3 rounded-full font-semibold transition-colors ${
                      isRunning 
                        ? 'bg-red-500 hover:bg-red-600 text-white' 
                        : 'bg-green-500 hover:bg-green-600 text-white'
                    }`}
                  >
                    {isRunning ? '‚èπÔ∏è Stop Reactor' : '‚ñ∂Ô∏è Start Reactor'}
                  </button>
                </div>

                {/* Reactor Status */}
                <div className="flex justify-center gap-4 mb-6 flex-wrap">
                  <div className="bg-blue-100 px-4 py-2 rounded-lg border-2 border-blue-300">
                    <div className="text-sm text-blue-600 font-semibold">Temperature</div>
                    <div className="text-xl font-bold text-blue-800">{temperature}¬∞C</div>
                  </div>
                  <div className="bg-green-100 px-4 py-2 rounded-lg border-2 border-green-300">
                    <div className="text-sm text-green-600 font-semibold">Liquid Level</div>
                    <div className="text-xl font-bold text-green-800">{Math.round(liquidLevel * 100)}%</div>
                  </div>
                  <div className="bg-purple-100 px-4 py-2 rounded-lg border-2 border-purple-300">
                    <div className="text-sm text-purple-600 font-semibold">Agitator Speed</div>
                    <div className="text-xl font-bold text-purple-800">{Math.round(agitatorRotation * 60) % 360} RPM</div>
                  </div>
                  <div className="bg-orange-100 px-4 py-2 rounded-lg border-2 border-orange-300">
                    <div className="text-sm text-orange-600 font-semibold">Status</div>
                    <div className="text-xl font-bold text-orange-800">{isRunning ? 'üü¢ Running' : 'üî¥ Stopped'}</div>
                  </div>
                </div>

                {/* Reactor Visualization */}
                <div className="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 1000" className="w-full max-w-2xl mx-auto reactor-svg">
                    <defs>
                      <marker id="l" orient="auto" overflow="visible">
                        <path stroke="#000" strokeWidth=".8pt" d="M3.92 0c0 2.208-1.792 4-4 4s-4-1.792-4-4 1.792-4 4-4 4 1.792 4 4z"/>
                      </marker>
                      <linearGradient id="c">
                        <stop offset="0" stopColor="#e86f43"/>
                        <stop offset="1" stopColor="#eedd3e"/>
                      </linearGradient>
                      <marker id="h" orient="auto" overflow="visible">
                        <path stroke="#000" strokeWidth=".8pt" d="M-10 0l-4 4L0 0l-14-4 4 4z"/>
                      </marker>
                      <linearGradient id="liquidGradient">
                        <stop offset="0" stopColor={getTemperatureColor(temperature)}/>
                        <stop offset=".5" stopColor="#fff"/>
                        <stop offset="1" stopColor={getTemperatureColor(temperature)}/>
                      </linearGradient>
                      <linearGradient id="coolantFlow">
                        <stop offset="0" stopColor="#0066cc" stopOpacity={isRunning ? "0.8" : "0.3"}>
                          {isRunning && <animateTransform
                            attributeName="stop-color"
                            values="#0066cc;#00aaff;#0066cc"
                            dur="2s"
                            repeatCount="indefinite"
                          />}
                        </stop>
                        <stop offset="1" stopColor="#87ceeb" stopOpacity={isRunning ? "0.6" : "0.2"}/>
                      </linearGradient>
                    </defs>

                    {/* Base reactor structure */}
                    <g fill="none" stroke="#000" strokeWidth="1.5">
                      <path d="M150.381 737.972V342.347"/>
                      <path d="M508.422 734.015V338.391"/>
                    </g>

                                         {/* Animated liquid with wave surface */}
                     <defs>
                       <pattern id="wavePattern" patternUnits="userSpaceOnUse" width="200" height="20" patternTransform={`translate(${isRunning ? (agitatorRotation * 2) % 200 : 0}, 0)`}>
                         <path d="M0,10 Q50,0 100,10 T200,10 V20 H0 Z" fill={getTemperatureColor(temperature)} opacity="0.8"/>
                       </pattern>
                       <clipPath id="reactorClip">
                         <rect x="150.5" y="338" width="358" height="400"/>
                       </clipPath>
                     </defs>
                     
                     {/* Main liquid body */}
                     <rect
                       x="151"
                       y={737 - getLiquidHeight()}
                       width="357"
                       height={getLiquidHeight()}
                       fill="url(#liquidGradient)"
                       opacity="0.7"
                       clipPath="url(#reactorClip)"
                     />
                     
                     {/* Wave surface layer */}
                     {liquidLevel > 0.1 && (
                       <rect
                         x="151"
                         y={737 - getLiquidHeight() - 10}
                         width="357"
                         height="20"
                         fill="url(#wavePattern)"
                         clipPath="url(#reactorClip)"
                       />
                     )}
                     
                     {/* Additional wave layers for more realistic effect */}
                     {isRunning && liquidLevel > 0.1 && (
                       <g opacity="0.3" clipPath="url(#reactorClip)">
                         <rect
                           x="151"
                           y={737 - getLiquidHeight() - 15}
                           width="357"
                           height="20"
                           fill="url(#wavePattern)"
                           transform={`translate(${(agitatorRotation * -1) % 200}, 0)`}
                         />
                       </g>
                     )}

                    {/* Animated feed flow */}
                    {feedFlow && (
                      <g>
                        <circle cx="455" cy="160" r="3" fill="#4CAF50" opacity="0.8">
                          <animate attributeName="cy" values="160;200;240;280;320" dur="1s" repeatCount="indefinite"/>
                          <animate attributeName="opacity" values="0.8;0.6;0.4;0.2;0" dur="1s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="455" cy="140" r="2" fill="#4CAF50" opacity="0.6">
                          <animate attributeName="cy" values="140;180;220;260;300" dur="1.2s" repeatCount="indefinite"/>
                          <animate attributeName="opacity" values="0.6;0.4;0.2;0.1;0" dur="1.2s" repeatCount="indefinite"/>
                        </circle>
                        <circle cx="455" cy="120" r="2" fill="#4CAF50" opacity="0.4">
                          <animate attributeName="cy" values="120;160;200;240;280" dur="0.8s" repeatCount="indefinite"/>
                          <animate attributeName="opacity" values="0.4;0.3;0.2;0.1;0" dur="0.8s" repeatCount="indefinite"/>
                        </circle>
                      </g>
                    )}



                    {/* Reactor vessel and components */}
                    <g fill="none" stroke="#000" strokeWidth="3">
                      {/* Static agitator shaft - doesn't rotate, only the blades do */}
                      <path d="M327.918 91.348v549.473"/>
                    </g>

                    {/* Animated agitator blades - using helicopter rotor technique */}
                    <g>
                      {/* Central shaft - static */}
                      <path fill="none" stroke="#000" strokeWidth="3" d="M259.178 643.022h132.534"/>
                      
                      {/* Rotor disc - flattened using scaleY like helicopter tutorial */}
                      <g transform={`translate(327.918, 645.494) scale(1, 0.075) translate(-327.918, -645.494)`}>
                        <circle cx="327.918" cy="645.494" r="120" 
                                fill="#a299ab" opacity="0.12" stroke="none"/>
                        
                        {/* Rotator container that spins inside the flattened disc */}
                        <g transform={`rotate(${agitatorRotation} 327.918 645.494)`}>
                          {/* Blade 1 - horizontal */}
                          <rect x="207.918" y="635.494" width="240" height="20" 
                                fill="#fff" opacity="0.8"/>
                          
                          {/* Blade 2 - vertical (90 degrees rotated) */}
                          <g transform={`rotate(90 327.918 645.494)`}>
                            <rect x="207.918" y="635.494" width="240" height="20" 
                                  fill="#fff" opacity="0.8"/>
                          </g>
                        </g>
                      </g>
                      
                      {/* Central hub - visible above the flattened disc */}
                      <circle cx="327.918" cy="645.494" r="8" fill="#666" stroke="#000" strokeWidth="1"/>
                    </g>

                    {/* Rest of the static reactor components */}
                    <g stroke="#000" strokeLinecap="round" strokeWidth="2">
                      <path fill="#9ec4d1" d="M126.945 334.452v-11.884H524.68v23.768H126.945v-11.884z"/>
                      <path fill="#a5c9d4" d="M153.703 290.954c16.675-16.31 53.211-31.56 97.44-40.67 19.868-4.092 30.593-4.748 78.102-4.78 47.926-.033 58.09.585 78.325 4.764 41.576 8.585 80.592 25.891 93.75 41.583l4.855 5.79H146.867l6.836-6.687z"/>
                      <path fill="#9ec4d1" d="M126.963 309.74v-12.13h398.221v24.258H126.963V309.74z"/>
                      <path fill="#85b1c1" d="M154.337 377.458h23.737v350.128h-23.737z"/>
                      <path fill="#85b1c1" d="M476.772 377.458h23.737v350.128h-23.737z"/>
                    </g>

                    {/* Motor - static, doesn't rotate */}
                    <g>
                      <path fill="#b5d1dc" stroke="#000" strokeLinecap="round" strokeWidth="1.492" 
                            d="M283.341 78.986V47.811h86.186v62.35h-86.186V78.986z"/>
                      {/* Optional: Add a small vibration effect when running */}
                      {isRunning && (
                        <g opacity="0.3">
                          <path fill="none" stroke="#666" strokeWidth="0.5" strokeDasharray="1,1"
                                d="M283.341 78.986V47.811h86.186v62.35h-86.186V78.986z"/>
                        </g>
                      )}
                    </g>

                    {/* Static components */}
                    <path d="M327.719 820.344v80.531h1.375v-80.531h-1.375z"/>
                    <path stroke="#000" strokeWidth="1.467" d="M328.412 887.116l-5.502-5.503 5.502 19.26 5.503-19.26-5.503 5.503z"/>
                    <path d="M454.375 137.844v66.781h1.281v-66.781h-1.281z"/>
                    <path stroke="#000" strokeWidth="1.346" d="M455.012 192.01l-5.048-5.048 5.048 17.668 5.048-17.668-5.048 5.048z"/>
                    <path fill="#a8ccd6" stroke="#000" strokeLinecap="round" d="M448.024 439.275V207.819h11.999v462.912h-12V439.275z"/>
     
                    {/* Labels */}
                    <g fontFamily="Arial, sans-serif" fontSize="16" fill="#333">
                      <text x="160" y="180">Motor</text>
                      <text x="470" y="180">Feed</text>
                      <text x="590" y="380">Cooling jacket</text>
                      <text x="590" y="500">Baffle</text>
                      <text x="590" y="620">Agitator</text>
                      <text x="328" y="940" textAnchor="middle">Mixed product</text>
                    </g>
                  </svg>

                  {/* Animation timeline visualization */}
                  <div className="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 className="text-lg font-semibold mb-3 text-gray-800">üïí Trajectory Timeline</h3>
                    <div className="flex justify-between text-sm text-gray-600 mb-2">
                      <span>0s</span>
                      <span>2s</span>
                      <span>5s</span>
                      <span>8s</span>
                      <span>10s</span>
                    </div>
                    <div className="h-3 bg-gray-200 rounded-full relative mb-4">
                      {trajectory.keyframes.map((keyframe, index) => (
                        <div
                          key={index}
                          className="absolute w-4 h-4 bg-blue-500 rounded-full -top-0.5 transform -translate-x-1/2 border-2 border-white shadow-lg"
                          style={{ left: `${(keyframe.time / trajectory.duration) * 100}%` }}
                        />
                      ))}
                    </div>
                    <div className="grid grid-cols-5 gap-2 text-xs">
                      <div className="bg-blue-50 p-2 rounded border border-blue-200">
                        <div className="font-semibold text-blue-800">Start</div>
                        <div>Temp: 25¬∞C</div>
                        <div>Level: 30%</div>
                      </div>
                      <div className="bg-green-50 p-2 rounded border border-green-200">
                        <div className="font-semibold text-green-800">Heating</div>
                        <div>Temp: 45¬∞C</div>
                        <div>Level: 50%</div>
                      </div>
                      <div className="bg-orange-50 p-2 rounded border border-orange-200">
                        <div className="font-semibold text-orange-800">Peak</div>
                        <div>Temp: 65¬∞C</div>
                        <div>Level: 70%</div>
                      </div>
                      <div className="bg-yellow-50 p-2 rounded border border-yellow-200">
                        <div className="font-semibold text-yellow-800">Cooling</div>
                        <div>Temp: 55¬∞C</div>
                        <div>Level: 80%</div>
                      </div>
                      <div className="bg-blue-50 p-2 rounded border border-blue-200">
                        <div className="font-semibold text-blue-800">End</div>
                        <div>Temp: 35¬∞C</div>
                        <div>Level: 60%</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Information Panel */}
                <div className="mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border-2 border-blue-200">
                  <h3 className="text-2xl font-bold text-gray-800 mb-4">üìä Reactor Information</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <h4 className="text-lg font-semibold text-gray-700 mb-2">üéØ Key Features</h4>
                      <ul className="space-y-2 text-gray-600">
                        <li>‚Ä¢ <strong>Temperature Control:</strong> Monitors and displays real-time temperature changes</li>
                        <li>‚Ä¢ <strong>Liquid Level:</strong> Tracks fluid level variations during operation</li>
                        <li>‚Ä¢ <strong>Agitator Speed:</strong> Shows rotating agitator with variable speed control</li>
                        <li>‚Ä¢ <strong>Feed Flow:</strong> Visualizes material input with animated particles</li>
                        <li>‚Ä¢ <strong>Cooling System:</strong> Animated coolant flow through jacket</li>
                      </ul>
                    </div>
                    <div>
                      <h4 className="text-lg font-semibold text-gray-700 mb-2">‚öôÔ∏è Operation Cycle</h4>
                      <ul className="space-y-2 text-gray-600">
                        <li>‚Ä¢ <strong>Startup:</strong> Initial heating phase with gradual temperature increase</li>
                        <li>‚Ä¢ <strong>Reaction:</strong> Peak temperature maintained for optimal conditions</li>
                        <li>‚Ä¢ <strong>Cooling:</strong> Controlled temperature reduction for product stability</li>
                        <li>‚Ä¢ <strong>Completion:</strong> Final temperature and level stabilization</li>
                        <li>‚Ä¢ <strong>Cycle:</strong> Continuous operation with 10-second cycles</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        // Render the component
        ReactDOM.render(<AnimatedReactor />, document.getElementById('root'));
    </script>
</body>
</html> 