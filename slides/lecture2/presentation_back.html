
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>RLC 2025 Talk &#8212; Practical Reinforcement Learning: From Algorithms to Applications</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["{\\boldsymbol #1}", 1]}, "processEscapes": true}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'slides/lecture2/presentation_back';</script>
    <script src="../../_static/iframe-modal.js?v=f72a1242"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Practical Reinforcement Learning: From Algorithms to Applications</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Why This Book?
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../modeling.html">Why Build a Model? For Whom?</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../ssm.html">Dynamics Models for Decision Making</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../simulation.html">Programs as Models</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numerical Trajectory Optimization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ocp.html">Discrete-Time Trajectory Optimization</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cocp.html">Trajectory Optimization in Continuous Time</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">From Trajectories to Policies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../mpc.html">From Trajectories to Policies</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../dp.html">Dynamic Programming</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Learning from Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../adp.html">Approximate Dynamic Programming</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../cadp.html">Policy Parametrization Methods</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../appendix_examples.html">Example COCPs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix_ivps.html">Solving Initial Value Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix_nlp.html">Nonlinear Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pierrelux/rlbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pierrelux/rlbook/edit/main/slides/lecture2/presentation_back.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pierrelux/rlbook/issues/new?title=Issue%20on%20page%20%2Fslides/lecture2/presentation_back.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/slides/lecture2/presentation_back.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>RLC 2025 Talk</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">RLC 2025 Talk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beyond-the-gym-interface">Beyond the Gym Interface</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tooling-isn-t-the-bottleneck-anymore">Tooling Isn’t the Bottleneck Anymore</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#but-the-rl-problem-is-defined-right">But the RL problem is defined, right?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-decision-contract">The Decision Contract</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-model-card-for-decisions">A Model Card for Decisions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#managing-hydroelectric-dams">Managing Hydroelectric Dams</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#w-windows-of-control">W — Windows of Control</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rules-of-the-game">Rules of The Game</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-problem-structure">Typical Problem Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-cost-structure">Nested Cost Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#taming-reward-complexity-with-a-surrogate">Taming Reward Complexity with a Surrogate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-fast-policies-with-safety-fallbacks">Learning Fast Policies with Safety Fallbacks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#but-the-policy-must-stay-in-the-feasible-region">But the policy must stay in the feasible region</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-learning-via-behavioral-cloning">Bootstrap Learning via Behavioral Cloning.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#policy-parameterization-and-feature-engineering">Policy Parameterization and Feature Engineering</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#takeaways">Takeaways</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-in-hvac">RL in HVAC</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-i-call-rl-here">What I Call RL Here</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#why-naive-rl-fails-in-hvac">Why Naive RL Fails in HVAC</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methodoloy-in-the-litterature">Methodoloy in the Litterature</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#onboarding-reality-2-days-or-2-years">Onboarding Reality: 2 Days or 2 Years?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-inductive-bias-matters">Why Inductive Bias Matters</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#physics-saves-you-samples">Physics Saves You Samples</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-structure-in-one-equation">Thermodynamic Structure in One Equation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#from-first-law-neural-ode">From First Law → Neural ODE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fast-deployment-better-control">Fast Deployment, Better Control</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-for-supermarket-refrigeration">RL for Supermarket Refrigeration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compressor-rack-optimization">Compressor Rack Optimization</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-a-solution-could-have-been">What a Solution Could Have Been</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-works-in-practice">What Works in Practice</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#when-we-optimize-live">When We Optimize Live</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-we-learned-from-these-projects">What We Learned from These Projects</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-next-frontier-transfer-and-scale">The Next Frontier: Transfer and Scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-beyond-policies-modeling-and-guidance">RL Beyond Policies: Modeling and Guidance</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-future-agent-looks-like">What the Future Agent Looks Like</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="rlc-2025-talk">
<h1>RLC 2025 Talk<a class="headerlink" href="#rlc-2025-talk" title="Link to this heading">#</a></h1>
<section id="beyond-the-gym-interface">
<h2>Beyond the Gym Interface<a class="headerlink" href="#beyond-the-gym-interface" title="Link to this heading">#</a></h2>
<p><em>Pierre-Luc Bacon</em><br />
Associate Professor – Université de Montréal<br />
<em>29-05-2025</em></p>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<div class="two-columns">
  <div class="column">
    <img src="2024milastreet1000x1000.jpg.webp" alt="Mila" style="width: 100%; height: 120px; object-fit: cover; object-position: center 30%; margin-bottom: 15px; display: block;">
    <strong>Mila</strong><br>
    Research institute founded by Université de Montréal and McGill University to advance AI research and foster academic–industry collaboration.
  </div>
  <div class="column">
    <img src="ivadolabs-ezgif.com-jpg-to-png-converter.png" alt="IVADO Labs" style="width: 100%; height: 120px; object-fit: cover; margin-bottom: 15px; display: block;">
    <strong>IVADO Labs</strong><br>
    Nonprofit organization applying AI research to industry problems, focusing on supply chain and operations for Canadian industry.
  </div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="tooling-isn-t-the-bottleneck-anymore">
<h1>Tooling Isn’t the Bottleneck Anymore<a class="headerlink" href="#tooling-isn-t-the-bottleneck-anymore" title="Link to this heading">#</a></h1>
<p>Today’s RL libraries are as polished as <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> was for SL.<br />
So why isn’t adoption mainstream?</p>
<ul class="simple">
<li><p>The hard part is <strong>upstream of the algorithm</strong>: defining the decision contract.</p></li>
<li><p>Objectives ≠ rewards: true KPIs are negotiated; constraints are real.</p></li>
<li><p>Evidence ≠ a curve: OPE is a smoke test; real impact needs A/B, DiD, synthetic control.</p></li>
<li><p>Environments ≠ Atari: new topologies, new buildings, governance matters.</p></li>
</ul>
<blockquote>
<div><p><em>John Rust (2019):<br />
“The biggest constraint on progress is not limited computer power,<br />
but the difficulty of learning the underlying structure of the decision problem.”</em></p>
</div></blockquote>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="but-the-rl-problem-is-defined-right">
<h1>But the RL problem is defined, right?<a class="headerlink" href="#but-the-rl-problem-is-defined-right" title="Link to this heading">#</a></h1>
<p><strong>Answer:</strong> It depends who you ask.</p>
<ul class="simple">
<li><p>If you mean the Suttonian long-term program: yes, the problem is defined. It’s an aspiration.</p></li>
<li><p>But in practice, the <strong>world is not given</strong>; there’s no firehose of safe experience.</p></li>
</ul>
<p>We must <strong>engineer the interface</strong>:</p>
<ul class="simple">
<li><p>Define goals, constraints, observability, cadences.</p></li>
<li><p>Accept rewards as surrogates; audit outcomes separately.</p></li>
<li><p>Keep humans in the loop; staged exploration with safety guardrails.</p></li>
<li><p>Prove impact via experiments, not just learning curves.</p></li>
</ul>
<p>If the interface is given, <strong>algorithms are the</strong> frontier.
If the interface is not given, <strong>modeling is the frontier</strong>.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="the-decision-contract">
<h1>The Decision Contract<a class="headerlink" href="#the-decision-contract" title="Link to this heading">#</a></h1>
<section id="a-model-card-for-decisions">
<h2>A Model Card for Decisions<a class="headerlink" href="#a-model-card-for-decisions" title="Link to this heading">#</a></h2>
<p><strong>What you must specify before learning anything:</strong></p>
<ul class="simple">
<li><p><strong>W</strong> — Windows of Control: sensing, decision, actuation cadences.</p></li>
<li><p><strong>R</strong> — Reward &amp; Risk: objective decomposition, constraints, audit plan.</p></li>
<li><p><strong>A</strong> — Actions &amp; Actuators: knobs, safety bounds, human-in-loop roles.</p></li>
<li><p><strong>P</strong> — Platform &amp; Pipeline: data freshness, logging, digital twin.</p></li>
<li><p><strong>P</strong> — Policies &amp; Priors: baselines (MPC, heuristics), role of learning.</p></li>
<li><p><strong>E</strong> — Evaluation: experimental design, OPE as smoke test.</p></li>
<li><p><strong>R</strong> — Real-World Governance: UX, explainability, rollback plan.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="managing-hydroelectric-dams">
<h1>Managing Hydroelectric Dams<a class="headerlink" href="#managing-hydroelectric-dams" title="Link to this heading">#</a></h1>
<p>Real-world deployment at IVADO Labs:</p>
<ul class="simple">
<li><p>Manage private hydroelectric dams for a large metal and mining company.</p></li>
<li><p>Provide <strong>daily decisions</strong> on outflow rates for each dam.</p></li>
<li><p>Objective: minimize power production costs and ensure safety.</p></li>
<li><p>Scale: 1000s of hm³ storage, 100s of m³/s flows.</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="w-windows-of-control">
<h1>W — Windows of Control<a class="headerlink" href="#w-windows-of-control" title="Link to this heading">#</a></h1>
<p>Our solution is online and realtime, but not in the typical sense.</p>
<img src="window_control.png" alt="Window Control" style="width: 80%; max-width: 600px; height: 300px; display: block; margin: 0 auto 5px auto; object-fit: cover; object-position: center;">
<ul class="simple">
<li><p><strong>Humans must be in the loop</strong>: Commands may require phone calls, manual intervention, and physical dispatch</p></li>
<li><p><strong>Water movement takes 1-3 days</strong> → decisions must anticipate delays</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="rules-of-the-game">
<h1>Rules of The Game<a class="headerlink" href="#rules-of-the-game" title="Link to this heading">#</a></h1>
<p>Safety is <strong>non-negotiable</strong>: violating constraints → floods, damage, shortages.</p>
<p>Operational rules:</p>
<ul class="simple">
<li><p>Reservoir volumes</p></li>
<li><p>Turbine capacity</p></li>
<li><p>Upstream–downstream delays</p></li>
<li><p>Power balance (including auxiliary power)</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="typical-problem-structure">
<h1>Typical Problem Structure<a class="headerlink" href="#typical-problem-structure" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Inflow = outflow</strong>: simple linear dynamics, but uncertainty exists (precipitation).</p></li>
<li><p>SDP and multi-scenario MPC work but don’t scale; LP solvers need convexification of the costs/constraints.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}\min_{u_{1:T}} \quad &amp; \sum_{t=1}^T \left[ C_{power}(t) + C_{penalty}(t) \right] \\\text{s.t.} \quad &amp; V_{t+1} = V_t + \Delta t \cdot (I_t - A \cdot u_t), \quad \forall t \in \{1, \ldots, T-1\} \\&amp; V_{min} \leq V_t \leq V_{max}, \quad \forall t \in \{1, \ldots, T\} \\&amp; 0 \leq u_t \leq u_{max}(h_t, MHT_t), \quad \forall t \in \{1, \ldots, T\} \\&amp; u_{min}(t) \leq u_t \leq u_{max}(t), \quad \forall t \in \{1, \ldots, T\} \\&amp; P_{hydro,t} + P_{HQ,t} + P_{gas,t} + P_{deficiency,t} = Load_t, \quad \forall t \in \{1, \ldots, T\} \\&amp; 0 \leq P_{HQ,t} \leq P_{HQ,max}(t), \quad \forall t \in \{1, \ldots, T\} \\&amp; 0 \leq P_{gas,t} \leq P_{gas,max}, \quad \forall t \in \{1, \ldots, T\} \\&amp; P_{deficiency,t} \geq 0, \quad \forall t \in \{1, \ldots, T\} \\&amp; V_1 = V_{initial} \\&amp; u_0 = u_{initial}\end{align}\end{split}\]</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="nested-cost-structure">
<h1>Nested Cost Structure<a class="headerlink" href="#nested-cost-structure" title="Link to this heading">#</a></h1>
<p>The cost function is itself a DP. The “outer agent” tefore chooses the plan flows, and the “inner” one allocates turbines. We can think of HRL.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\max_{\{q_j\}} \quad &amp; \sum_j P_j(h_j, q_j, \text{turbine\_type}_j) \\
\text{s.t.} \quad &amp; \sum_j q_j = Q_{\text{total}} \\
&amp; q_{j,min}(h_j, \text{turbine\_type}_j) \leq q_j \leq q_{j,max}(h_j, \text{turbine\_type}_j) \\
&amp; P_{j,min}(h_j, \text{turbine\_type}_j) \leq P_j(h_j, q_j, \text{turbine\_type}_j) \leq P_{j,max}(h_j, \text{turbine\_type}_j) \\
&amp; h_j = h_{gross} - h_{losses}(Q_{total}) - h_{aval}(\text{plant\_specific}) \\
&amp; q_{j,max}(h_j) = \min\left(q_{turbine,max}(h_j), q_{cavitation}(h_j), q_{safety}(h_j)\right) \\
&amp; \text{plant\_specific\_constraints}(h_j, q_j, \text{downstream\_levels})
\end{align}\end{split}\]</div>
<p>This is a sequential allocation problem: how much power to allocate to each turbine. Takes into account turbine capacity curves from the manufacturer, vibration limits, etc.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="taming-reward-complexity-with-a-surrogate">
<h1>Taming Reward Complexity with a Surrogate<a class="headerlink" href="#taming-reward-complexity-with-a-surrogate" title="Link to this heading">#</a></h1>
<p>Solving a nested DP, too expensive if we want to take lots of rollout. Therefore, we prefer instead learning a surrogate model of the form:</p>
<div class="math notranslate nohighlight">
\[\hat{P}_{\text{total}} = f_\theta(V, Q, \text{MHT}) \quad \text{where } f_\theta \approx \text{DP Output}\]</div>
<p><strong>What this allows us to do:</strong></p>
<ul class="simple">
<li><p><strong>Massive speedup:</strong> from 10³ to 10⁶+ simulations.</p></li>
<li><p><strong>Differentiable end-to-end:</strong> policy gradients without implicit differentiation.</p></li>
<li><p><strong>Keeps physics fidelity:</strong> surrogate trained on DP-generated data.</p></li>
</ul>
<p>This is similar to the idea of “best response functions” methods in bilevel optimization.</p>
<p>(Btw, its also fully jitted thanks to JAX)</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="learning-fast-policies-with-safety-fallbacks">
<h1>Learning Fast Policies with Safety Fallbacks<a class="headerlink" href="#learning-fast-policies-with-safety-fallbacks" title="Link to this heading">#</a></h1>
<p><strong>Previous setup:</strong></p>
<ul class="simple">
<li><p>Multi-scenario MPC solves a sequence of very large LPs every day.</p></li>
<li><p>We evaluate the scenarios over 70 years of inflow</p></li>
<li><p>It has to be ready by the morning!</p></li>
</ul>
<p><strong>New approach:</strong></p>
<ul>
<li><p>We “amortize” this expensive computation in a parametrized policy:</p>
<div class="math notranslate nohighlight">
\[u_t = \pi_\theta(s_t)\]</div>
<p>instead of re-solving LPs each time.</p>
</li>
<li><p>This then runs in <strong>milliseconds</strong> at deployment.</p></li>
</ul>
<p>But how do we enforce the operational constraints?</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="but-the-policy-must-stay-in-the-feasible-region">
<h1>But the policy must stay in the feasible region<a class="headerlink" href="#but-the-policy-must-stay-in-the-feasible-region" title="Link to this heading">#</a></h1>
<p><strong>Operational constraints we must respect:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp;u_{\min} \le u_t \le u_{\max}(h_t), \\
&amp;u_t \le u_{\text{cap}}(h_t), \; u_t \le u_{\text{cav}}(h_t), \\
&amp;s_{\min} \le s_t \le s_{\max}, \\
&amp;P_{\text{hydro}}(u_t,h_t)+P_{\text{aux}}\ge P_{\text{demand}}.
\end{align}\end{split}\]</div>
<p><strong>We enforce them with:</strong></p>
<ul class="simple">
<li><p><strong>Action parameterization</strong>: <span class="math notranslate nohighlight">\(u^{\text{raw}}_t \xrightarrow{\sigma(\cdot)} u_t' \in [u_{\min}, u_{\max}(h_t)]\)</span></p></li>
<li><p><strong>Safety-layer projection</strong>: <span class="math notranslate nohighlight">\(\tilde u_t = \Pi_{\mathcal K(h_t)}(u_t'),\;\; \mathcal K(h_t)=\{\text{capacity \&amp; cavitation limits}\}\)</span></p></li>
<li><p><strong>Fast feasibility check</strong> before sending commands:</p>
<ul>
<li><p>If passes → apply <span class="math notranslate nohighlight">\(\tilde u_t\)</span>.</p></li>
<li><p>Else → fallback to MPC action.</p></li>
</ul>
</li>
</ul>
<p>We still keep the MPC alive to mitigate deployment risk, and fallback when the fast RL policy is infeasible. Very important for change management too!</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="bootstrap-learning-via-behavioral-cloning">
<h1>Bootstrap Learning via Behavioral Cloning.<a class="headerlink" href="#bootstrap-learning-via-behavioral-cloning" title="Link to this heading">#</a></h1>
<p>We <strong>pre-train</strong> our policy on historical data to bootstrap learning in the right region: <strong>Behaviorcal Cloning</strong></p>
<ul class="simple">
<li><p>This also gives us a baseline which is useful for our KPIs</p></li>
<li><p>While our BC policy performs remarkably in terms of RMSE, we can’t trust SL alone to generalize safely everywhere, hence the importance of RL + MPC fallback.</p>
<ul>
<li><p>We can train on human operator data</p></li>
<li><p>On the output of the MPC controller</p></li>
<li><p>Balance deviation using a KL term.</p></li>
</ul>
</li>
<li><p>Another advantage of starting with BC is that it informs us of design choices down the line when choosing the policy parametrization</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="policy-parameterization-and-feature-engineering">
<h1>Policy Parameterization and Feature Engineering<a class="headerlink" href="#policy-parameterization-and-feature-engineering" title="Link to this heading">#</a></h1>
<p>Representation learning alone isn’t enough here. Unlike image-based RL, there is no raw “pixel input.”
The state must capture physical realities and operational rules that can’t emerge from scratch via deep features.</p>
<p><strong>Multi-Output MLP</strong>: Residual connections with Swish activation and LayerNorm</p>
<p><strong>Feature Engineering (249 total):</strong></p>
<ul class="simple">
<li><p><strong>Temporal</strong>: Cyclical month/day encoding, 1-10 day lags, rolling means</p></li>
<li><p><strong>Physical Constraints (57)</strong>: Capacity utilization, overflow/shortage risk</p></li>
<li><p><strong>Water Levels (16)</strong>: Converted from volumes, daily changes, rolling averages</p></li>
<li><p><strong>Flow Constraints (21)</strong>: Max capacity, utilization, headroom, turbine groups</p></li>
<li><p><strong>Predictions</strong>: Daily/weekly/monthly inflow forecasts</p></li>
<li><p><strong>Coordination</strong>: Upstream lagged outflows (1-3 day delays)</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="takeaways">
<h1>Takeaways<a class="headerlink" href="#takeaways" title="Link to this heading">#</a></h1>
<p>Real-world impact comes from thoughtful integration, not from pushing new methods everywhere.</p>
<ul class="simple">
<li><p>Decision tools already work: Industry partners have robust processes and expertise.</p></li>
<li><p>Collaboration matters: Success came from building on what exists, not replacing it.</p></li>
<li><p>RL is a complement, not a replacement: Adds value where amortization and speed matter.</p></li>
<li><p>Start from reality: Understand constraints, operator workflow, and risk tolerance first.</p></li>
</ul>
<p>AI adoption is about fit: The best projects begin where there’s already domain maturity.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="rl-in-hvac">
<h1>RL in HVAC<a class="headerlink" href="#rl-in-hvac" title="Link to this heading">#</a></h1>
<p>HVAC control is everywhere: small improvements scale to massive energy and cost savings.</p>
<ul class="simple">
<li><p>HVAC accounts for <strong>40–50% of building energy use</strong>, making it one of the largest energy consumers in the built environment.</p></li>
<li><p>Current systems already use control, but mostly <strong>rule-based or PID</strong> with some MPC in advanced setups.</p></li>
</ul>
<p>These methods work, yet they struggle with:</p>
<ul class="simple">
<li><p>High variability: Weather, occupancy, internal gains.</p></li>
<li><p>Multiple timescales: Seconds for fans, hours for temperature, days for envelope.</p></li>
<li><p>Complex dynamics: Nonlinear, coupled, with hard constraints.</p></li>
</ul>
<p><strong>Why RL?</strong>
Potential to adapt online, learn from data, and optimize across conflicting objectives: comfort, energy, cost, emissions.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="what-i-call-rl-here">
<h1>What I Call RL Here<a class="headerlink" href="#what-i-call-rl-here" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>This is <strong>RL in spirit</strong>, but not what you see in benchmarks: No PPO, no DQN, no temporal-difference targets.</p></li>
<li><p>The core idea: <strong>Learn from experience</strong>, <strong>plan using that knowledge</strong>, <strong>improve decision-making over time</strong></p></li>
<li><p>Why this matters: Real systems like HVAC have <strong>hard constraints</strong>, physics, and safety rules. These shape the “game” we play.</p></li>
<li><p>So before diving in, remember: <strong>RL is a paradigm, not a recipe.</strong></p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="why-naive-rl-fails-in-hvac">
<h1>Why Naive RL Fails in HVAC<a class="headerlink" href="#why-naive-rl-fails-in-hvac" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Simulator‑first fallacy</strong>: Building accurate digital twins takes months — material types, occupancy behavior, thermal physics. Many retrofit projects lack historical logs.</p></li>
<li><p><strong>Black‑box learning is costly</strong>: Requires vast quantities of data and has poor sample efficiency.</p></li>
<li><p><strong>Unsafe exploration</strong>: Comfort breaches and energy wastage are unacceptable. Live buildings cannot be used for random policy trials.</p></li>
<li><p><strong>No structure → slow learning</strong>: Black‑box RL relearns basic thermodynamics from scratch. Comfort is fuzzy; reward design is challenging.</p></li>
</ul>
<p><strong>Takeaway:</strong> We need RL approaches that exploit structure, respect constraints, and start from what we know.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="methodoloy-in-the-litterature">
<h1>Methodoloy in the Litterature<a class="headerlink" href="#methodoloy-in-the-litterature" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>A recent review (<strong>Khabbazi et al., 2025</strong>) found <strong>71% of field demonstrations</strong> used <strong>protocols prone to unreliable estimates</strong>.</p></li>
<li><p>Even among the credible <strong>29%</strong>, reported gains are modest: <strong>13–16% energy or cost savings</strong> that rarely account for deployment costs.</p></li>
<li><p>Many studies assume perfect digital twins, unlimited simulation rollouts, and simplified objectives (e.g., only energy use).</p>
<ul>
<li><p><strong>71 % of field demonstrations</strong> of MPC and RL for HVAC used <strong>protocols prone to unreliable estimates</strong>.</p></li>
<li><p>Even among the credible <strong>29 %</strong>, reported gains are modest:</p>
<ul>
<li><p><strong>13–16 % energy or cost savings</strong></p></li>
<li><p>Rarely account for deployment costs or operational complexity.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Implication:</strong> Naive RL approaches fail not only in practice but also in methodology.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="onboarding-reality-2-days-or-2-years">
<h1>Onboarding Reality: 2 Days or 2 Years?<a class="headerlink" href="#onboarding-reality-2-days-or-2-years" title="Link to this heading">#</a></h1>
<section id="why-inductive-bias-matters">
<h2>Why Inductive Bias Matters<a class="headerlink" href="#why-inductive-bias-matters" title="Link to this heading">#</a></h2>
<p>Onboarding cannot take <strong>months</strong>. Full digital twins are slow and expensive.</p>
<ul class="simple">
<li><p>Pure black-box RL:</p>
<ul>
<li><p>Needs huge data</p></li>
<li><p>Could take <strong>years</strong> to be reliable</p></li>
</ul>
</li>
<li><p>Smarter approach:</p>
<ul>
<li><p>Add structure from physics and constraints</p></li>
<li><p>Model energy flows, not just correlations</p></li>
</ul>
</li>
</ul>
<p><strong>First-law residual:</strong><br />
$<span class="math notranslate nohighlight">\(
R(t) = (\text{heat in} + \text{heat out} + \text{work}) - \text{change in stored energy}
\)</span>$</p>
<p><strong>Key point:</strong> Inductive bias accelerates learning and keeps policies feasible and safe.</p>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="physics-saves-you-samples">
<h1>Physics Saves You Samples<a class="headerlink" href="#physics-saves-you-samples" title="Link to this heading">#</a></h1>
<img src="thermodynamics.png" alt="Thermodynamics" style="height: 40%; width: auto; display: block; margin: 0 auto;">
<ul class="simple">
<li><p>Energy <strong>cannot disappear</strong>. When you add heat to a zone, the net energy balance must rise.</p></li>
<li><p>Disturbances (e.g., an open window) simply <strong>add an extra heat-loss term</strong>; the balance still holds.</p></li>
<li><p>Pure black-box models can break this rule, predicting temperature drops while heating is applied.</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="thermodynamic-structure-in-one-equation">
<h1>Thermodynamic Structure in One Equation<a class="headerlink" href="#thermodynamic-structure-in-one-equation" title="Link to this heading">#</a></h1>
<p>For a single zone model, we have:</p>
<div class="math notranslate nohighlight">
\[
C \frac{dT}{dt} \;=\; \sum_{i} U_i \,(T_i - T)\;+\; Q_{\text{HVAC}}\;+\; Q_{\text{internal}}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C\)</span> thermal capacitance of the zone</p></li>
<li><p><span class="math notranslate nohighlight">\(U_i\)</span> conductance to neighboring zones or outside</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_{\text{HVAC}}\)</span> heating / cooling input</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_{\text{internal}}\)</span> gains from occupants and equipment</p></li>
</ul>
<p>Adding this single ODE pins the model to energy conservation, cuts the search space, and speeds learning.</p>
<p><strong>Moving to continuous-time models is natural here!</strong></p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="from-first-law-neural-ode">
<h1>From First Law → Neural ODE<a class="headerlink" href="#from-first-law-neural-ode" title="Link to this heading">#</a></h1>
<p><strong>How we enforce energy balance</strong></p>
<ol class="arabic simple">
<li><p>Split the latent state:  <span class="math notranslate nohighlight">\(z = \bigl[z_{\mathcal E}\;,\; z_{T}\bigr]\)</span>
where <span class="math notranslate nohighlight">\(z_{\mathcal E}\)</span> tracks <strong>HVAC energy</strong> and <span class="math notranslate nohighlight">\(z_{T}\)</span> tracks <strong>temperature</strong>.</p></li>
<li><p>Use a structured vector field that <strong>couples the two</strong> exactly as the first-law ODE:<br />
$<span class="math notranslate nohighlight">\(
\begin{aligned}
\dot z_{\mathcal E} &amp;= P_\theta(s,a,d) \\
\dot z_{T} &amp;= \tfrac{1}{C_p}\,\bigl(Q_\theta(s,a,d) + \eta P_\theta(s,a,d)\bigr)
\end{aligned}
\)</span><span class="math notranslate nohighlight">\(
– \)</span>P_\theta<span class="math notranslate nohighlight">\( and \)</span>Q_\theta<span class="math notranslate nohighlight">\( are learned networks for HVAC power and other gains.  
– \)</span>C_p<span class="math notranslate nohighlight">\( and \)</span>\eta$ are learnable or fixed physical parameters.</p></li>
<li><p>Train end-to-end with the usual MSE loss; the structure <strong>guarantees</strong> energy-conserving dynamics, so no extra penalty terms are needed.</p></li>
</ol>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="fast-deployment-better-control">
<h1>Fast Deployment, Better Control<a class="headerlink" href="#fast-deployment-better-control" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Physics-informed Neural ODE + gradient planning</strong></p>
<ul>
<li><p>92 % DR events satisfied (vs 86 % rule-based)</p></li>
<li><p>15 % less comfort drift during events</p></li>
</ul>
</li>
<li><p><strong>Sample-efficient</strong></p>
<ul>
<li><p>Same control accuracy with <strong>≈ 50 % less data than a discrete RNN</strong> (Taboga et al., 2024)</p></li>
</ul>
</li>
<li><p><strong>Field validation</strong></p>
<ul>
<li><p>Applied to real data from 5 commercial buildings in collaboration with <strong>BrainboxAI (now Trane)</strong></p></li>
<li><p>Onboarding time measured in <strong>days, not months</strong></p></li>
</ul>
</li>
</ul>
<p><strong>Takeaway:</strong> encoding basic physics cuts data needs and hits DR targets sooner — a practical path to rapid HVAC deployments.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="rl-for-supermarket-refrigeration">
<h1>RL for Supermarket Refrigeration<a class="headerlink" href="#rl-for-supermarket-refrigeration" title="Link to this heading">#</a></h1>
<p>Let me tell you about this other industry project, this time with IVADO Labs and a major Canadian grocery chain</p>
<ul class="simple">
<li><p>Refrigeration accounts for <strong>40–60% of store electricity use</strong></p></li>
<li><p>Energy bills are about <strong>$4–5 per square foot annually</strong>, which is more than $200,000 for a typical store</p></li>
<li><p>Grocery profit margins are very thin, typically <strong>1–3% of sales</strong></p></li>
<li><p>Every <strong>$1 saved on energy equals about $50–60 in additional sales</strong></p></li>
</ul>
<p><strong>Implication:</strong>
Reducing refrigeration energy by just <strong>1%</strong> can have the same impact on profits as a large increase in revenue. This is why the problem matters for industry.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="compressor-rack-optimization">
<h1>Compressor Rack Optimization<a class="headerlink" href="#compressor-rack-optimization" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Refrigeration racks in the machine room supply dozens of display cases through a shared <strong>suction header</strong></p></li>
<li><p><strong>Suction pressure</strong> controls the evaporating temperature in all cases</p></li>
<li><p><strong>Floating suction pressure</strong> = adjusting this setpoint over time</p>
<ul>
<li><p>Lower pressure → colder coils, higher energy use</p></li>
<li><p>Higher pressure → energy savings, risk of food warming</p></li>
</ul>
</li>
<li><p><strong>Challenge</strong></p>
<ul>
<li><p>One control affects the whole network</p></li>
<li><p>Loads change unpredictably (door openings, defrost, ambient)</p></li>
<li><p>Fast compressor cycling vs slow case temperature dynamics</p></li>
</ul>
</li>
</ul>
<p><strong>Goal:</strong> Minimize energy use while maintaining food safety and operational reliability.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="what-a-solution-could-have-been">
<h1>What a Solution Could Have Been<a class="headerlink" href="#what-a-solution-could-have-been" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Detailed physics-based models exist for supermarket refrigeration</p>
<ul>
<li><p>Example: Danfoss benchmark model (Larsen et al., 2007)</p></li>
<li><p>Multi-state ODEs for air, product, walls, and refrigerant dynamics</p></li>
</ul>
</li>
<li><p>These models can deliver accurate simulation and MPC <strong>but</strong>:</p>
<ul>
<li><p>Require deep expertise and manual tuning</p></li>
<li><p>Depend on full visibility into equipment and sensors</p></li>
<li><p>Heavy integration: piping data through APIs and custom databases</p></li>
</ul>
</li>
<li><p>For a large, diverse fleet:</p>
<ul>
<li><p>Hard to replicate and maintain across hundreds of stores</p></li>
<li><p>Slows onboarding by weeks or months</p></li>
</ul>
</li>
</ul>
<p><strong>Reality:</strong> Full digital twin approaches are powerful but not practical for rapid, large-scale deployment.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="what-works-in-practice">
<h1>What Works in Practice<a class="headerlink" href="#what-works-in-practice" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>There is no single RL module that solves everything</p></li>
<li><p>Real-world deployments are <strong>multi-pronged</strong>:</p>
<ul>
<li><p>Optimize setpoints when safe and feasible</p></li>
<li><p>Detect and correct <strong>fault conditions</strong> early: often the biggest savings</p>
<ul>
<li><p>Stuck valves, failed sensors, clogged filters</p></li>
<li><p>Symptoms: compressors short-cycling, suction pressure oscillating, energy spikes (<a class="reference external" href="https://axiomcloud.ai/blog/floating-suction">Axiom Cloud, 2023</a>)</p></li>
</ul>
</li>
<li><p>Alert technicians instead of pushing aggressive real-time control</p></li>
</ul>
</li>
<li><p>Why this matters:</p>
<ul>
<li><p>A single fix can recover <strong>10–20% energy</strong> without changing any control policy</p></li>
<li><p>Safer and faster than blindly tuning suction setpoints at high frequency</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="when-we-optimize-live">
<h1>When We Optimize Live<a class="headerlink" href="#when-we-optimize-live" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Focus shifts to <strong>controller tuning</strong> for energy savings; not black box policies.</p></li>
<li><p>What works:</p>
<ul>
<li><p><strong>Simple thermodynamic model + BO-MPC</strong></p></li>
<li><p>Or <strong>contextual BO online</strong> for cold-start</p></li>
</ul>
</li>
<li><p>Benefits:</p>
<ul>
<li><p>Sample-efficient</p></li>
<li><p>Safe, adaptive to ambient and load conditions</p></li>
</ul>
</li>
<li><p>Updates happen over <strong>hours or days</strong>, not every second</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="what-we-learned-from-these-projects">
<h1>What We Learned from These Projects<a class="headerlink" href="#what-we-learned-from-these-projects" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Real-world deployment is not about picking PPO or SAC</p></li>
<li><p>The hardest part is <strong>modeling and integration</strong>, not the algorithm</p></li>
<li><p>One-size-fits-all RL does not exist</p>
<ul>
<li><p>Practical solutions combine analytics, fault detection, and adaptive control</p></li>
</ul>
</li>
<li><p>Safe, sample-efficient methods are essential for fast onboarding</p></li>
</ul>
<p><strong>Bottom line:</strong> Progress in modeling will bring RL closer to reality.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="the-next-frontier-transfer-and-scale">
<h1>The Next Frontier: Transfer and Scale<a class="headerlink" href="#the-next-frontier-transfer-and-scale" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Every building today is a new project</p></li>
<li><p>Transfer learning would change the game:</p>
<ul>
<li><p>Learn from many buildings and adapt to new ones with little data</p></li>
</ul>
</li>
<li><p>Why this matters:</p>
<ul>
<li><p>The HVAC market is massive; even small gains have big impact</p></li>
</ul>
</li>
<li><p>Why hard:</p>
<ul>
<li><p>Multi-morphology systems, diverse sensors, incomplete logs</p></li>
<li><p>No internet-scale datasets yet</p></li>
</ul>
</li>
<li><p>First signs:</p>
<ul>
<li><p>AutoBEM models over <strong>125M building footprints</strong> in the US</p></li>
<li><p>Similar initiatives in Canada and Quebec</p></li>
</ul>
</li>
</ul>
<p>This is the next ALE moment for energy systems.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="rl-beyond-policies-modeling-and-guidance">
<h1>RL Beyond Policies: Modeling and Guidance<a class="headerlink" href="#rl-beyond-policies-modeling-and-guidance" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>LLMs can encode standards, safety rules, and expert practices</p></li>
<li><p>Promising directions:</p>
<ul>
<li><p>Guide data collection and model building</p></li>
<li><p>Use LLM reasoning in <strong>Bayesian optimization</strong> for tuning</p></li>
<li><p>Fault detection and anomaly diagnosis from telemetry</p></li>
</ul>
</li>
<li><p>Long-term opportunities:</p>
<ul>
<li><p>Generate symbolic or hybrid models</p></li>
<li><p>Assist in defining agents via structured code or constraints</p></li>
</ul>
</li>
</ul>
<p>The goal: move from blind exploration to expert-informed strategies.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="what-the-future-agent-looks-like">
<h1>What the Future Agent Looks Like<a class="headerlink" href="#what-the-future-agent-looks-like" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Not a giant black-box policy</p></li>
<li><p>A modular system:</p>
<ul>
<li><p>Physics-informed models for dynamics</p></li>
<li><p>Transferable priors for different HVAC configurations</p></li>
<li><p>A reasoning layer for fault handling and planning</p></li>
</ul>
</li>
<li><p>Foundation models for control are the big opportunity</p>
<ul>
<li><p>Pretraining across buildings</p></li>
<li><p>Fast adaptation to new sites</p></li>
</ul>
</li>
</ul>
<p><strong>Takeaway:</strong> RL in the real world will look like a hybrid of learning, modeling, and reasoning.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./slides/lecture2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">RLC 2025 Talk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beyond-the-gym-interface">Beyond the Gym Interface</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tooling-isn-t-the-bottleneck-anymore">Tooling Isn’t the Bottleneck Anymore</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#but-the-rl-problem-is-defined-right">But the RL problem is defined, right?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-decision-contract">The Decision Contract</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-model-card-for-decisions">A Model Card for Decisions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#managing-hydroelectric-dams">Managing Hydroelectric Dams</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#w-windows-of-control">W — Windows of Control</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rules-of-the-game">Rules of The Game</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-problem-structure">Typical Problem Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-cost-structure">Nested Cost Structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#taming-reward-complexity-with-a-surrogate">Taming Reward Complexity with a Surrogate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-fast-policies-with-safety-fallbacks">Learning Fast Policies with Safety Fallbacks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#but-the-policy-must-stay-in-the-feasible-region">But the policy must stay in the feasible region</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-learning-via-behavioral-cloning">Bootstrap Learning via Behavioral Cloning.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#policy-parameterization-and-feature-engineering">Policy Parameterization and Feature Engineering</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#takeaways">Takeaways</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-in-hvac">RL in HVAC</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-i-call-rl-here">What I Call RL Here</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#why-naive-rl-fails-in-hvac">Why Naive RL Fails in HVAC</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methodoloy-in-the-litterature">Methodoloy in the Litterature</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#onboarding-reality-2-days-or-2-years">Onboarding Reality: 2 Days or 2 Years?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-inductive-bias-matters">Why Inductive Bias Matters</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#physics-saves-you-samples">Physics Saves You Samples</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-structure-in-one-equation">Thermodynamic Structure in One Equation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#from-first-law-neural-ode">From First Law → Neural ODE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fast-deployment-better-control">Fast Deployment, Better Control</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-for-supermarket-refrigeration">RL for Supermarket Refrigeration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compressor-rack-optimization">Compressor Rack Optimization</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-a-solution-could-have-been">What a Solution Could Have Been</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-works-in-practice">What Works in Practice</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#when-we-optimize-live">When We Optimize Live</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-we-learned-from-these-projects">What We Learned from These Projects</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-next-frontier-transfer-and-scale">The Next Frontier: Transfer and Scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rl-beyond-policies-modeling-and-guidance">RL Beyond Policies: Modeling and Guidance</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-future-agent-looks-like">What the Future Agent Looks Like</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pierre-Luc Bacon
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>